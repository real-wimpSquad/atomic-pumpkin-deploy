# Code Thumbs Addon - Development (uses pre-built :latest images)
# Multi-language code formatting, linting, and auto-fixing tools

services:
  # Code formatter/linter tools container (pre-built image)
  code-thumbs:
    image: ghcr.io/real-wimpsquad/code-thumbs:latest
    container_name: ape_code_thumbs
    restart: unless-stopped
    volumes:
      - ../..:/workspace
    working_dir: /workspace
    command: tail -f /dev/null
    networks:
      - atomic_pumpkin

  # Code Thumbs API - HTTP/MCP/OpenAI interface (pre-built image)
  code-thumbs-api:
    image: ghcr.io/real-wimpsquad/code-thumbs-api:latest
    container_name: ape_code_thumbs_api
    restart: unless-stopped
    ports:
      - "${CODE_THUMBS_PORT:-8072}:8072"
    volumes:
      - ../..:/workspace
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - PYTHONUNBUFFERED=1
      - PORT=8072
      - CODE_THUMBS_CONTAINER=ape_code_thumbs
    depends_on:
      - code-thumbs
    networks:
      - atomic_pumpkin
    healthcheck:
      test: ["CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:8072/health', timeout=5).read()"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  atomic_pumpkin:
